---
title: 数据科学：因果推断（四）—— 随机化实验
date: 2021-03-24 15:29:53
tags: 
    - 数据科学
categories:
    - 数据科学
---

随机化实验是因果推断的黄金标准，是观测研究的基础。

## 控制 or 随机
在传统的因果推断思想中，尤其是自然科学的研究中，人们往往采用**控制**的方法，将影响结果的所有其他因素控制住，仅让关心的变量变化，看看结果如何变化。这种情况下，结果的变化就是关心的变量造成的影响。比如物理学中，自然状态下，铁球和羽毛的运行规律是不同的。物体的运动受到地球引力、空气阻力、温度、湿度等因素的影响，但物理学家主要关注地球引力对物体运动的影响。因而，他们采用控制的方法，通过抽真空的方式，将影响物体运动的其他因素控制住，发现铁球和羽毛的运行规律相同。

随机化实验采用不同的思路，它不要求将所有其他影响因素控制住，只要求干预分配是**随机**化的。随机化的分配机制可以帮助排除其他因素的影响，这是与“控制法”完全不同的一种思维方式。Fisher（1935）在其经典著作《实验设计》中首次提出了“随机化实验”的思想，指出我们不必控制其他变量差异，现实中也没有办法完全控制所有的其他变量，只要让随机机制决定干预变量的分配，就可以获得正确的因果效应。随机化的关键作用是可以平衡两组个体其他因素的分布，使得两组个体的各协变量（包括可观测变量和未观测变量）具有相同的分布，从而使得两组个体具有可比性。

回到教育收益率的例子，假设可以做随机化实验，考察大学教育 D 对个人收入 Y 的影响。对于一个特定总体，对他们的教育进行随机化分配，比如通过投均匀硬币的方式，正面让他接受大学教育，反面就只让他完成高中教育。直接比较这两类人的收入就可以得到大学教育对个人收入的平均因果效应。尽管这两组个体除随机化赋值的教育变量外，在其他方面，比如能力、家庭背景等可能仍然存在着差异，但这种差异是随机性的，由“随机定律”控制，不会影响估计结果。用经典计量经济学的语言表述，可以构建下列模型：

$$
log(Y_i)=\beta_0 + \beta_1D_i + \varepsilon_i \tag{1}
$$

其中左边是对数收入，右边是教育变量 $D_i$，$\varepsilon_i$ 为其他影响因素。尽管还有很多其他影响收入的因素，但教育变量 $D_i$ 的取值是随机化的，与其他未观测因素 $\varepsilon_i$（其他影响收入的因素）不相关，满足经典线性回归模型的基本假设，因而可以得到教育收益率 $\beta_1$ 的一致估计。

另一个例子是美国田纳西州教育实验项目，为了考察学校的班级规模与学生学习效果的关系，1985—1986 学年开始，79 个学校的幼儿园学生和教师被随机分配到两种规模的班级：小班（13—17个学生）、正常班（22—25个学生），每年大约 6000—7000 名学生参与项目，4 年共 11600 名学生参与。项目要求参与学校每种类型的班级至少有一个班，随机化分配是在学校内部进行的，每学年学期末会进行一次标准化的考试以检验学生学习效果:

![](https://likeitea-1257692904.cos.ap-guangzhou.myqcloud.com/liketea_blog/star_032401.png)

上表给出了两种班级的主要特征变量和分数的比较统计，前三个协变量基本相似：是否提供免费午餐、种族、年龄分布。但流失率有较大差异，小班流失率低，而正常班的流失率会高一些，在分析时需要考虑这一点。

## 随机化实验与选择偏差
在随机化实验中，干预状态是随机化分配的。这意味着，对于每一个个体，它的两个潜在结果 $(Y_{1i}，Y_{0i})$ 哪一个会实现，是由分配机制随机决定的，并且分配机制不依赖于潜在结果，即满足非混杂性：

$$
(Y_{1i},Y_{0i})\perp D_i \tag{2}
$$

这意味着以下两个式子成立：

$$
E[Y_{0i}｜D_i=1]=E[Y_{0i}｜D_i=0] \tag{3}
$$

$$
E[Y_{1i}｜D_i=1]=E[Y_{1i}｜D_i=0] \tag{4}
$$

当干预变量是 $0-1$ 二值变量时，$Y_i$ 对 $D_i$ 的**回归系数** $\hat{\tau}^{ols}$ 等于干预组和控制组**样本均值之差**，在大样本的情况下，依概率趋近于**总体平均因果效应**（$\tau_{ATE}$）：

