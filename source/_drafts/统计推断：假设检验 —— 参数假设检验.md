---
title: 统计推断：假设检验 —— 参数检验
date: 2020-11-05 14:16:46
tags: 
   - 统计
categories: 
   - 统计
---

参数检验（parameter test）全称参数假设检验，是指当总体分布的形式已知时，根据样本数据对总体分布的统计参数进行推断。参数假设检验的基本思想是**小概率反证法**，小概率思想认为小概率事件在一次试验中实际上是几乎不可能发生的，反证法思想认为如果假设成立会导致小概率事件，那么原假设大概率不成立。

<div align=center>
    <img src="https://likeitea-1257692904.cos.ap-guangzhou.myqcloud.com/liketea_blog/p_value.jpg" width="60%" heigh="80%"></img>
</div>

## 步骤
参数检验的一般步骤可以总结为：

1. 构造假设：结合需要验证的问题提出原假设和备择假设，根据反证法惯例，一般会将我们想要拒绝的假设作为原假设，将我们想要得到的假设作为备择假设；
2. 随机采样：$X=\{X_1, X_2, ..., X_n\}$
3. 计算检验统计量 $T$ 和 $P$ 值：
    1. 观测统计量：根据样本分布和统计假设选择合适的统计量作为检验统计量 $T$，$T$ 的计算只与样本和统计量的形式有关，而与假设无关；
    2. 观测显著性水平：$P$ 值表示当原假设 $H_0$ 为真时，出现 $T$ 统计量或更极端情形的概率，$P$ 值与检验统计量 $T$ 和原假设 $H_0$ 有关；
4. 确定显著性水平 $\alpha$ 和拒绝域 $R$：
    1. 理论显著性水平：$\alpha$ 是人为设置用于判断是否要拒绝原假设的阈值，表示当原假设为真但却拒绝了原假设的概率，$\alpha$ 反映了我们对于错杀概率的容忍度，$\alpha$ 越小表示我们越严格，越不希望原假设被错杀；
    2. 理论统计量：按照 $\alpha$ = P(当 $H_0$ 为真拒绝 $H_0$) 确定拒绝域 $R$，$R$ 的确定和 $\alpha$ 、原假设 $H_0$ 以及检验统计量形式有关；
5. 比较 $T$ 和 $R$ 或者 $P$ 值和 $\alpha$，得出结论；


### 构造假设
参数检验要解决的问题是，给定一个概率模型以及关于未知的参数 $\theta$ 的假设，判断该假设是否成立。我们定义两个不重叠的区域 $\Omega_0$ 和 $\Omega_1$，我们的 `Null hypothesis`（原假设）等同于 $\theta$ 落在 $\Omega_0$ 内，而 `Alternative hypothesis`（备择假设）等同于 $\theta$ 落在 $\Omega_1$ 内：

$$
\begin{align*}
&H_0: \theta \in \Omega_0  \text{  Null hypothesis} \\
&H_1: \theta \in \Omega_1  \text{  Alternative hypothesis}
\end{align*}
$$

举个例子，$\theta$ 表示某个硬币出现正面向上的概率，大家之前认为该硬币是正反均匀的，而我们猜想该硬币其实不均匀，这种情况下如何进行假设检验？首先，我们把硬币是均匀的定义为 $H_0$，而把我们的怀疑定为 $H_1$，这种假设下 $\Omega_0$ 和 $\Omega_1$ 可以定义为：

$$
\begin{align*}
\Omega_0 &= \{\theta | \theta=0.5\} \\
\Omega_1 &= \{\theta | \theta \neq 0.5, 0< \theta <1\}
\end{align*}
$$

在数轴上，备择假设 $H_1$ 中 $\theta$ 的值位于 $H_0$ 中 $\theta$ 取值的左右两侧，称为**双边检验问题**。如果我们的怀疑是硬币向上的几率更大，这时 $\Omega_0$ 和 $\Omega_1$ 可以被定义为：

$$
\begin{align*}
\Omega_0 &= \{\theta | \theta=0.5\} \\
\Omega_1 &= \{\theta | 0.5< \theta <1\}
\end{align*}
$$

在数轴上，备择假设 $H_1$ 中 $\theta$ 的值位于 $H_0$ 中 $\theta$ 的右侧，称为**右侧检验问题**。左侧检验和右侧检验被统称为单边检验。

### 随机采样
为了了解 $\theta$ 到底是多少，我们得开始进行采样，定义 n 次采样的集合为：$X=\{X_1, X_2, ..., X_n\}$。

### 计算 $T$ & $P$
检验统计量（`Test statistics`）$T$ 表示的是我们从采样数据 $X$ 中计算而来的重要数值，这个数值包含了所有我们关心的有关 $X$ 的信息，已经可以用于代替 $X$。$T$ 的取值通常与 $X$ 的分布与要验证的假设有关，这里不做展开，很多情况下 $T=\bar{X}_n$。


### 确定 $\alpha$ & $R$
我们通过观察 $T$ 的值来决定 $H_0$ 与 $H_1$ 正确的可能性，当 $T$ 属于某个范围 $R$ 时，拒绝 $H_0$，反之不拒绝 $H_0$，这个范围叫做拒绝域 `Reject Region`。`Power function` 表示对于不同的参数，统计量落在拒绝域的概率：

$$
\pi(\theta) = P(T \in R | \theta)
$$

下图是某个 `Power function` 的曲线，横坐标表示 $\theta$（途中显示的是 p），图中 $\Omega_0 = \{\theta | \theta<=0.02\}$，$\Omega_1 = \{\theta | \theta>0.02\}$，而不同的 c 对应的就是不同的拒绝域 $R = \{T|T>c\}$：

![](https://likeitea-1257692904.cos.ap-guangzhou.myqcloud.com/liketea_blog/xxx09.jpg)

 






## 示例

小概率原理：小概率事件在一次试验中几乎是不可能发生的。

假设检验原理：基于前提假设计算样本统计量，如果统计量落在尾部小概率事件范围内，则应拒绝前提假设。


小概率原理


参数假设检验的一般步骤：

1. 构造假设：原假设、备择假设
2. 随机采样：
3. 计算样本的检验统计量、P 值：
4. 确定拒绝域、显著性水平：
5. 比较样本统计量和拒绝域、P 值和显著性水平，得出结论

概念：

参数（原域、备择域） 
统计量（接受域、拒绝域）
一类/二类错误：疑罪从无 矛盾的 
P 值 显著性水平 

### 检验种类
按假设形式分：双边检验、单边检验（左侧检验、右边检验）

按参数分：
    单正态均值检验：假设=>统计量 t检验
    双正态均值比较：z 检验
    成对数据均值比较：成对差值作为参数
    单正态方差检验：卡方检验
    双正态方差比较：F 检验
    
分布假设检验
列联表独立性检验

### P 值法


### 区间估计
置信区间

μ 的置信水平为 0.95 的置信区间
    

假设检验：由假设能不能推出一个小概率事件 参数范围=>统计量范围

区间估计：统计量范围=>参数范围，这个参数范围是置信水平为 95% 的置信区间


![](https://likeitea-1257692904.cos.ap-guangzhou.myqcloud.com/liketea_blog/p_value.jpg)



P 值是由检验统计量计算的样本观察值得出的原假设可被拒绝的最小显著性水平

在实践中，人们将假设检验中所发生的第一类错误的概率的最大允许值称为检验的显著性水平；而把P值称为观察显著性水平

![](https://likeitea-1257692904.cos.ap-guangzhou.myqcloud.com/liketea_blog/xpasj.jpg)


P-value is a statement about data in relation to a specified hypothetical explanation, and is not a statement about the explanation itself.译：P-value 是关于数据和指定假设之间关系的陈述；而非关于假设本身的陈述。

p-value 代表着原假设下观测到某（极端）事件的条件概率

























### 构造假设










## 参考
- Trustworthy Online Controlled Experiments
- 